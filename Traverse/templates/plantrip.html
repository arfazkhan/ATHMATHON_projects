{% extends 'Dashboardbase.html' %} {% load static %} {% block content %}
<style>
  .autocomplete-items {
    position: absolute;
    z-index: 9999;
    margin-top: 0;
    margin-bottom: 0;
    background-color: #fff;
    border: 1px solid #d4d4d4;
    border-bottom: none;
    border-top: none;
    max-height: 250px;
    overflow-y: auto;
  }

  .autocomplete-items div {
    padding: 2px;
    cursor: pointer;
    background-color: #fff;
    border-bottom: 1px solid #d4d4d4;
  }

  .autocomplete-items div:hover {
    background-color: #e9e9e9;
  }
</style>
<div class="container-fluid">
  <div class="row">
    <div class="col-lg-12">{% include 'plantrip/planned_tripcontent.html' %}</div>
    <!-- <div class="col-lg-6">{% include 'plantrip/friendscontent.html' %}</div> -->
  </div>
</div>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAxaPlVxe-HTnuBzPajIUoXQSxiqoMitLc&libraries=places"></script>
<script>
  var autocompleteService = new google.maps.places.AutocompleteService();
  var placeNameInput = document.getElementById("placeName");
  var autocompleteDropdown = document.getElementById("autocomplete-dropdown");
  var latitudeInput = document.getElementById("latitude");
  var longitudeInput = document.getElementById("longitude");
  var delayTimer;

  placeNameInput.addEventListener("input", function () {
    var input = placeNameInput.value;

    clearTimeout(delayTimer);

    if (input.length >= 3) {
      autocompleteService.getPlacePredictions({ input: input }, function (results, status) {
        if (status === google.maps.places.PlacesServiceStatus.OK) {
          var html = "";
          for (var i = 0; i < results.length; i++) {
            html += "<div>" + results[i].description + "</div>";
          }
          autocompleteDropdown.innerHTML = html;
          autocompleteDropdown.style.display = "block";
        } else {
          console.log("Error retrieving place predictions:", status);
        }
      });
    } else {
      autocompleteDropdown.style.display = "none";
    }

    delayTimer = setTimeout(function () {}, 3000);
  });

  autocompleteDropdown.addEventListener("click", function (event) {
    var selectedPlace = event.target.innerHTML;

    placeNameInput.value = selectedPlace;
    if (placeNameInput.value === "") {
      placeNameInput.value = placeNameInput.placeholder;
    }
    // Use the Places service to get the details of the selected place
    var placesService = new google.maps.places.PlacesService(document.createElement("div"));
    placesService.textSearch({ query: selectedPlace }, function (results, status) {
      if (status === google.maps.places.PlacesServiceStatus.OK) {
        // Store the latitude and longitude in the input fields
        latitudeInput.value = results[0].geometry.location.lat();
        longitudeInput.value = results[0].geometry.location.lng();
      } else {
        console.log("Error retrieving place details:", status);
      }
    });

    autocompleteDropdown.style.display = "none";
  });

  document.querySelectorAll('input[name="share_facilities"]').forEach(function (input) {
    input.addEventListener("change", function () {
      if (this.value === "yes") {
        document.querySelector("#ifShareFacilities").style.display = "block";
      } else {
        document.querySelector("#ifShareFacilities").style.display = "none";
      }
    });
  });

  const modeOfTravel = document.getElementById("modeOfTravel");
  const sharing_facilities = document.getElementById("shareing_facilities");

  modeOfTravel.addEventListener("change", () => {
    if (modeOfTravel.value === "solo") {
      sharing_facilities.style.display = "none";
    } else if (modeOfTravel.value === "team") {
      sharing_facilities.style.display = "block";
    }
  });
</script>
{% endblock %}
